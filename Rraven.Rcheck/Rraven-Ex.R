pkgname <- "Rraven"
source(file.path(R.home("share"), "R", "examples-header.R"))
options(warn = 1)
base::assign(".ExTimings", "Rraven-Ex.timings", pos = 'CheckExEnv')
base::cat("name\tuser\tsystem\telapsed\n", file=base::get(".ExTimings", pos = 'CheckExEnv'))
base::assign(".format_ptime",
function(x) {
  if(!is.na(x[4L])) x[1L] <- x[1L] + x[4L]
  if(!is.na(x[5L])) x[2L] <- x[2L] + x[5L]
  options(OutDec = '.')
  format(x[1L:3L], digits = 7L)
},
pos = 'CheckExEnv')

### * </HEADER>
library('Rraven')

base::assign(".oldSearch", base::search(), pos = 'CheckExEnv')
base::assign(".old_wd", base::getwd(), pos = 'CheckExEnv')
cleanEx()
nameEx("exp_empty_sels")
### * exp_empty_sels

flush(stderr()); flush(stdout())

base::assign(".ptime", proc.time(), pos = "CheckExEnv")
### Name: exp_empty_sels
### Title: Export a 'Raven' selection for all sound files in a folder
### Aliases: exp_empty_sels

### ** Examples


# Load data
library(warbleR)
data(list = c("Phae.long1", "Phae.long2", "Phae.long3", "Phae.long4", "selec.table"))

# Export a single selection table including multiple files
writeWave(Phae.long1, "Phae.long1.wav", extensible = FALSE) #save sound files 
writeWave(Phae.long2, "Phae.long2.wav", extensible = FALSE)
writeWave(Phae.long3, "Phae.long3.wav", extensible = FALSE)
writeWave(Phae.long4, "Phae.long4.wav", extensible = FALSE)

# export with no file name
exp_empty_sels()

# export with file name
exp_empty_sels(file.name = "Phaethornis.longirostris")




base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
base::cat("exp_empty_sels", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
cleanEx()
nameEx("exp_est")
### * exp_est

flush(stderr()); flush(stdout())

base::assign(".ptime", proc.time(), pos = "CheckExEnv")
### Name: exp_est
### Title: Export wave objects of extended selection tables as sound files
### Aliases: exp_est

### ** Examples

{
# First set temporary folder
# setwd(tempdir())

# load example data
data(list = "Phae.long.est", package = "NatureSounds")

# subset to 10 selections
X <- Phae.long.est[1:10, ]

# Export data to a single sound file
exp_est(X, file.name = "test", single.file = TRUE)

# Export data to a single sound file and normalizing, no pb
exp_est(X, file.name = "test2", single.file = TRUE, normalize = TRUE, pb = FALSE)

# several files
exp_est(X, single.file = FALSE, file.name = "test3")
}




base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
base::cat("exp_est", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
cleanEx()
nameEx("exp_raven")
### * exp_raven

flush(stderr()); flush(stdout())

base::assign(".ptime", proc.time(), pos = "CheckExEnv")
### Name: exp_raven
### Title: Export 'Raven' selections
### Aliases: exp_raven

### ** Examples


# Load data
library(warbleR)
data(list = c("Phae.long1", "Phae.long2", "Phae.long3", "Phae.long4", "selec.table"))

# Select data for a single sound file
st1 <- selec.table[selec.table$sound.files == "Phae.long1.wav", ]

# Export data of a single sound file
exp_raven(st1, file.name = "Phaethornis 1")

# Export a single selection table including multiple files
writeWave(Phae.long1, "Phae.long1.wav", extensible = FALSE) #save sound files 
writeWave(Phae.long2, "Phae.long2.wav", extensible = FALSE)
writeWave(Phae.long3, "Phae.long3.wav", extensible = FALSE)
writeWave(Phae.long4, "Phae.long4.wav", extensible = FALSE)

exp_raven(X = selec.table, file.name = "Phaethornis multiple sound files",
 single.file = TRUE, sound.file.path = getwd())




base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
base::cat("exp_raven", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
cleanEx()
nameEx("extract_ts")
### * extract_ts

flush(stderr()); flush(stdout())

base::assign(".ptime", proc.time(), pos = "CheckExEnv")
### Name: extract_ts
### Title: Extract time series parameters from data imported from 'Raven'
### Aliases: extract_ts

### ** Examples


# Load data
data(selection_files)

#save 'Raven' selection tables in the temporary directory 
writeLines(selection_files[[5]], con = names(selection_files)[5])





base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
base::cat("extract_ts", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
cleanEx()
nameEx("fix_path")
### * fix_path

flush(stderr()); flush(stdout())

base::assign(".ptime", proc.time(), pos = "CheckExEnv")
### Name: fix_path
### Title: Modify sound file path in Raven's selection tables
### Aliases: fix_path

### ** Examples

{

# load warbleR for sound file examples
library(warbleR)

#load data 
data(list = c("Phae.long1", "Phae.long2", "Phae.long3", "Phae.long4", "selection_files"))

# set temporary directory
# setwd(tempdir())

# save sound files
writeWave(Phae.long1,"Phae.long1.wav")
writeWave(Phae.long2,"Phae.long2.wav")
writeWave(Phae.long3,"Phae.long3.wav")
writeWave(Phae.long4,"Phae.long4.wav")   
# save 'Raven' selection tables in the temporary directory
out <- lapply(1:2, function(x)
writeLines(selection_files[[x]], con = names(selection_files)[x]))

# try drag and drop selection files into Raven (shouldn't work)

# now fix files
fix_path(path = getwd(), 
sound.file.col = "Begin File", new.begin.path = "YOUR NEW LOCATION HERE")

# try drag and drop into Raven again (should work now)
}




base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
base::cat("fix_path", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
cleanEx()
nameEx("imp_corr_mat")
### * imp_corr_mat

flush(stderr()); flush(stdout())

base::assign(".ptime", proc.time(), pos = "CheckExEnv")
### Name: imp_corr_mat
### Title: Import 'Raven' batch correlator output
### Aliases: imp_corr_mat

### ** Examples

## Not run: 
##D  
##D # Load data
##D library(warbleR)
##D data(list = c("Phae.long1", "Phae.long2", "Phae.long3", "Phae.long4", "selec.table"))
##D 
##D writeWave(Phae.long1, "Phae.long1.wav", extensible = FALSE) #save sound files 
##D writeWave(Phae.long2, "Phae.long2.wav", extensible = FALSE)
##D writeWave(Phae.long3, "Phae.long3.wav", extensible = FALSE)
##D writeWave(Phae.long4, "Phae.long4.wav", extensible = FALSE)
##D 
##D #create new folder to put cuts
##D dir.create("cuts")
##D 
##D # cut files
##D cut_sels(X = selec.table, mar = 0.05, path = tempdir(), dest.path = file.path(tempdir(), "cuts"))
##D 
##D #Now run 'Raven' batch correlator un the cuts and save the output in the same folder
##D 
##D # Import output (change the name of the file if you used a different one)
##D xcorr.rav <- imp_corr_mat(file = "BatchCorrOutput.txt", 
##D path = file.path(tempdir(), "cuts"))
##D 
##D # check results
##D   
##D ## correlation matrix
##D xcorr.rav[[1]]
##D 
##D ## time lag matrix
##D xcorr.rav[[2]]
## End(Not run)




base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
base::cat("imp_corr_mat", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
cleanEx()
nameEx("imp_raven")
### * imp_raven

flush(stderr()); flush(stdout())

base::assign(".ptime", proc.time(), pos = "CheckExEnv")
### Name: imp_raven
### Title: Import 'Raven' selections
### Aliases: imp_raven

### ** Examples


#load data 
data(selection_files)

# set temporary directory
# setwd(tempdir())

#save 'Raven' selection tables in the temporary directory 
out <- lapply(1:2, function(x) 
writeLines(selection_files[[x]], con = names(selection_files)[x]))





base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
base::cat("imp_raven", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
cleanEx()
nameEx("imp_syrinx")
### * imp_syrinx

flush(stderr()); flush(stdout())

base::assign(".ptime", proc.time(), pos = "CheckExEnv")
### Name: imp_syrinx
### Title: Import 'Syrinx' selections
### Aliases: imp_syrinx

### ** Examples

## Not run: 
##D #load data 
##D data(selection_files)
##D 
##D #save 'Raven' selection tables in the temporary directory 
##D writeLines(selection_files[[7]], con = names(selection_files)[7])
##D 
##D syr.dat <- imp_syrinx(all.data = FALSE)
##D 
##D # View(syr.dat)
##D 
##D #getting all the data
##D syr.dat <- imp_syrinx(all.data = TRUE)
##D 
##D # View(syr.dat)
## End(Not run)




base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
base::cat("imp_syrinx", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
cleanEx()
nameEx("match_wav_case")
### * match_wav_case

flush(stderr()); flush(stdout())

base::assign(".ptime", proc.time(), pos = "CheckExEnv")
### Name: match_wav_case
### Title: Fix the extension case of sound files
### Aliases: match_wav_case

### ** Examples

library(warbleR)
data(list = c("Phae.long1", "Phae.long2", "Phae.long3", "Phae.long4", 
"selec.table"))

writeWave(Phae.long1, "Phae.long1.wav", extensible = FALSE) #save sound files 
writeWave(Phae.long2, "Phae.long2.wav", extensible = FALSE)
writeWave(Phae.long3, "Phae.long3.wav", extensible = FALSE)
writeWave(Phae.long4, "Phae.long4.wav", extensible = FALSE)

# change one extension
selec.table$sound.files <- as.character(selec.table$sound.files)
selec.table$sound.files[1] <- gsub("\\.wav$", ".WAV", selec.table$sound.files[1]) 
 
 # fixed extension an return data frame
 match_wav_case(X = selec.table)
  
 # fixed extension an return sound file names
 match_wav_case(X = selec.table, output = "names")
    



base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
base::cat("match_wav_case", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
cleanEx()
nameEx("raven_batch_detec")
### * raven_batch_detec

flush(stderr()); flush(stdout())

base::assign(".ptime", proc.time(), pos = "CheckExEnv")
### Name: raven_batch_detec
### Title: Run 'Raven' batch detector
### Aliases: raven_batch_detec

### ** Examples

## Not run: 
##D 
##D # here replace with the path where 'Raven' is install in your computer
##D raven.path <- "PATH_TO_RAVEN_DIRECTORY_HERE" 
##D 
##D # Run detector on raven example sound files
##D 
##D # single sound file using 'Amplitude Detector' 
##D detec.res <- raven_batch_detec(raven.path = raven.path, 
##D sound.files = "BlackCappedVireo.aif", path = file.path(raven.path, "Examples"), 
##D detector.type = "Amplitude Detector")
##D 
##D # on raven examples  2 files
##D detec.res <- raven_batch_detec(raven.path = raven.path, 
##D sound.files = c("BlackCappedVireo.aif", "CanyonWren.wav"), 
##D path = file.path(raven.path, "Examples"), detector.type = "Amplitude Detector")
##D 
##D # using 'Band Limited Energy Detector' 
##D detec.res <- raven_batch_detec(raven.path = raven.path, 
##D sound.files = c("BlackCappedVireo.aif", "CanyonWren.wav"), 
##D path = file.path(raven.path, "Examples"), detector = "Band Limited Energy Detector")
## End(Not run)




base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
base::cat("raven_batch_detec", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
cleanEx()
nameEx("relabel_colms")
### * relabel_colms

flush(stderr()); flush(stdout())

base::assign(".ptime", proc.time(), pos = "CheckExEnv")
### Name: relabel_colms
### Title: Relabel columns to match the selection table format
### Aliases: relabel_colms

### ** Examples


# Load data
data(selection_files)

#save 'Raven' selection tables in the temporary directory 
writeLines(selection_files[[5]], con = names(selection_files)[5])





base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
base::cat("relabel_colms", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
cleanEx()
nameEx("run_raven")
### * run_raven

flush(stderr()); flush(stdout())

base::assign(".ptime", proc.time(), pos = "CheckExEnv")
### Name: run_raven
### Title: Open sound files in 'Raven' sound analysis software
### Aliases: run_raven

### ** Examples

## Not run: 
##D # First set temporary folder
##D setwd(tempdir())
##D 
##D # save sound files
##D library(warbleR) 
##D data(list = c("Phae.long1", "Phae.long2", "Phae.long3", "Phae.long4"))
##D writeWave(Phae.long1, "Phae.long1.wav", extensible = FALSE)
##D writeWave(Phae.long2, "Phae.long2.wav", extensible = FALSE)
##D 
##D # here replace with the path where 'Raven' is install in your computer
##D raven.path <- "PATH_TO_RAVEN_DIRECTORY_HERE" 
##D 
##D # run function 
##D run_raven(raven.path = raven.path, sound.files = c("Phae.long1.wav", "Phae.long2.wav"),
##D  at.the.time = 2, import = T, name.from.file = T, ext.case = "upper", 
##D  all.data = TRUE, path = tempdir())  
##D  
##D #getting all the data
##D rav.dat<-run_raven(all.data = TRUE, raven.path = raven.path)
##D # View(rav.dat)
##D 
##D writeWave(Phae.long3, "Phae.long3.wav", extensible = FALSE)
##D writeWave(Phae.long4, "Phae.long4.wav", extensible = FALSE)
##D 
##D # run function on all the wav files in the working directory 3 at the time
##D run_raven(raven.path = raven.path, sound.files = list.files(pattern = "\\.wav$", 
##D ignore.case = TRUE, path = tempdir()), at.the.time = 3, import = FALSE, 
##D path = tempdir())
##D   
## End(Not run)




base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
base::cat("run_raven", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
cleanEx()
nameEx("to_sound_selection")
### * to_sound_selection

flush(stderr()); flush(stdout())

base::assign(".ptime", proc.time(), pos = "CheckExEnv")
### Name: to_sound_selection
### Title: Convert Raven's selection files into sound selection files
### Aliases: to_sound_selection

### ** Examples

{

#load data 
data(selection_files)

# set temporary directory
# setwd(tempdir())

# save 'Raven' selection tables in the temporary directory
out <- lapply(1:2, function(x)
writeLines(selection_files[[x]], con = names(selection_files)[x]))

# try drag and drop selection files into Raven (shouldn't work)

# now convert files
to_sound_selection(sound.file.path = getwd(), 
sound.file.col = "Begin Path")

# try drag and drop into Raven again (should work now)
}




base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
base::cat("to_sound_selection", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
### * <FOOTER>
###
cleanEx()
options(digits = 7L)
base::cat("Time elapsed: ", proc.time() - base::get("ptime", pos = 'CheckExEnv'),"\n")
grDevices::dev.off()
###
### Local variables: ***
### mode: outline-minor ***
### outline-regexp: "\\(> \\)?### [*]+" ***
### End: ***
quit('no')
